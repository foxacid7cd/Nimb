#!/bin/sh

NVIM_PATH=".build/bin/nvim"
GENERATE_CMD="swift run --package-path Modules generate"

GENERATED_DIR="Modules/Sources/Neovim/generated"
${NVIM_PATH} --api-info | eval "${GENERATE_CMD} ${GENERATED_DIR}"

SWIFTFORMAT="/opt/homebrew/bin/swiftformat"
if [ -x "${SWIFTFORMAT}" ]; then
  "${SWIFTFORMAT}" --config ".swiftformat" "${GENERATED_DIR}"
fi
